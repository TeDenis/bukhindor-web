# Active Context

## Текущий фокус работы
Полная интеграция Flutter веб-приложения с реальным API Bukhindor Backend (https://api.go-dev.kz). Замена mock-аутентификации на реальную систему с JWT токенами, автоматическим обновлением токенов и детальной обработкой ошибок.

## Последние изменения
- ✅ **ПОЛНАЯ ИНТЕГРАЦИЯ С API**: Заменена mock-аутентификация на реальную систему
- ✅ **Добавлены HTTP зависимости**: dio, dio_smart_retry, shared_preferences
- ✅ **Создана конфигурация API**: ApiConfig с базовым URL и эндпоинтами
- ✅ **Созданы модели данных**: Полный набор API моделей согласно OpenAPI схеме
- ✅ **Реализован токен менеджер**: TokenManager для работы с JWT токенами в localStorage
- ✅ **Создан API сервис**: ApiService с Dio клиентом и interceptors
- ✅ **Автоматическое обновление токенов**: При получении 401 ошибки
- ✅ **Обновлен репозиторий**: AuthRepositoryImpl для работы с реальным API
- ✅ **Улучшен BLoC**: Добавлены отдельные состояния загрузки и детальная обработка ошибок
- ✅ **Клиентская валидация**: ValidationUtils согласно API схеме
- ✅ **Обновлены формы**: Использование новой валидации и состояний загрузки
- ✅ **Детальное отображение ошибок**: Показ технических деталей в SnackBar
- ✅ **Проверка токенов при запуске**: Автоматическая проверка при старте приложения

## Текущее состояние
- **Полная интеграция с API** `https://api.go-dev.kz`:
  - **HTTP клиент**: Dio с retry логикой и interceptors
  - **JWT токены**: Автоматическое сохранение и обновление
  - **Модели данных**: Соответствуют OpenAPI схеме
  - **Валидация**: Клиентская валидация согласно API требованиям
  - **Обработка ошибок**: Детальное отображение ошибок API
  - **Состояния загрузки**: Отдельные состояния для входа, регистрации и сброса пароля

- Система версионирования включает:
  - **Константы версии** в `lib/core/constants/app_constants.dart`
  - **Страницу версии** `/version` с полной информацией
  - **Виджеты** для отображения информации о версии, заметок о релизе и информации о разработке
  - **Инструкцию** по версионированию в `VERSIONING.md`
  - **Автоматический скрипт** `scripts/bump_version.sh` для обновления версии
  - **Ссылки** на страницу версии в главной странице и меню пользователя

- Секретные функции доступа:
  - **4 клика на логотип совы** открывают диалог для перехода на страницу версии
  - **Таймаут 3 секунды** между кликами для сброса счетчика
  - **Анимация при клике** с эффектом bounce
  - **Кнопка возврата** к авторизации на странице версии
  - **Диалог подтверждения** перед открытием страницы версии

- **Docker оптимизация**:
  - **Улучшенный Dockerfile** с принудительной очисткой и пересборкой
  - **Файл .dockerignore** для исключения ненужных файлов
  - **Обновленный docker-compose.yml** с healthcheck
  - **Скрипт docker-rebuild.sh** для решения проблем с кэшированием
  - **Документация** по использованию в scripts/README.md

## Следующие шаги
- Тестирование интеграции с API
- Проверка всех сценариев аутентификации
- Тестирование автоматического обновления токенов
- Проверка обработки сетевых ошибок
- Тестирование валидации форм
- Оптимизация производительности
- Возможные улучшения UX

## Активные решения
- **Интеграция с реальным API**: Замена mock-данных на API вызовы
- **JWT токены**: Автоматическое управление access и refresh токенами
- **Retry логика**: Автоматические повторы при сетевых ошибках
- **Interceptor паттерн**: Автоматическое добавление токенов к запросам
- **Клиентская валидация**: Согласно API схеме с детальными сообщениями
- **Отдельные состояния загрузки**: Для каждой операции аутентификации
- **Детальная обработка ошибок**: Показ технических деталей пользователю
- **Автоматическая проверка токенов**: При запуске приложения
- **Безопасное хранение**: Токены в localStorage через SharedPreferences